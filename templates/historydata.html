<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>CSV Data Display</title>
	<style>
		table {
			width: 100%;
			border-collapse: collapse;
			margin-top: 20px;
		}

		table,
		th,
		td {
			border: 1px solid black;
			padding: 8px;
			text-align: center;
		}
	</style>
</head>

<body>
	<h2>Select Region:</h2>
	<select id="regionSelect" onchange="loadCSV()">
		<option value="west">West</option>
		<option value="north">North</option>
		<option value="central">Central</option>
		<option value="east">East</option>
		<option value="south">South</option>
	</select>
	<div id="tableContainer"></div>

	<script>
		function loadCSV() {
			const selectedRegion = document.getElementById("regionSelect").value;
			const tableContainer = document.getElementById("tableContainer");
			const csvUrl = `/static/csv/${selectedRegion}.csv`;

			fetch(csvUrl)
				.then(response => response.text())
				.then(data => {
					const rows = data.split('\n');
					let tableHTML = '<table><thead><tr>';
					// Assume first row contains headers
					const headers = rows[0].split(',');
					headers.forEach(header => {
						tableHTML += `<th>${header}</th>`;
					});
					tableHTML += '</tr></thead><tbody>';

					// Start iterating from the second row (index 1)
					for (let i = 1; i < rows.length; i++) {
						const columns = rows[i].split(',');
						if (columns.length === 13) {
							tableHTML += '<tr>';
							columns.forEach(column => {
								tableHTML += `<td>${column}</td>`;
							});
							tableHTML += '</tr>';
						}
					}

					tableHTML += '</tbody></table>';
					tableContainer.innerHTML = tableHTML;
				})
				.catch(error => {
					console.error('Error fetching CSV:', error);
					tableContainer.innerHTML = '<p>Failed to load data. Please try again later.</p>';
				});
		}
	</script>
</body>

</html>